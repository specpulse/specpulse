description = "Track project progress without SpecPulse CLI"

prompt = """
## Command: /sp-status [feature-name]

**CLI-Independent Project Progress Tracking**

When called with `/sp-status {{args}}`, I will:

### Step 1: Parse Arguments to Determine Scope

**I will analyze the arguments:**
- If feature name provided: Show detailed status for that feature
- If no argument: Show overview of all features
- Parse options like --verbose, --validate, --trends

### Step 2: Detect Current Feature Context

**I will identify the current working feature:**
- Check `.specpulse/memory/context.md` for active feature
- Look for most recently modified spec/plan/task directory
- Validate feature directory exists and is properly structured
- Extract feature ID and name from directory structure

### Step 3: For Overall Project Status (no arguments)

**I will scan and analyze all features:**

#### A. Feature Discovery
- Scan `.specpulse/specs/`, `.specpulse/plans/`, `.specpulse/tasks/` directories
- Identify all feature directories using naming convention (XXX-feature-name)
- Build comprehensive feature inventory

#### B. Feature Status Assessment
For each feature, I will determine:
- **Active**: Currently has open tasks or recent activity
- **Completed**: All tasks marked as done
- **In Progress**: Has some completed tasks with work remaining
- **Paused**: No recent activity but not all tasks complete
- **Blocked**: Has blocked tasks preventing progress

#### C. Project-Level Metrics
Calculate overall statistics:
```
TOTAL_FEATURES=5
ACTIVE_FEATURES=2
COMPLETED_FEATURES=1
IN_PROGRESS_FEATURES=1
PAUSED_FEATURES=1
OVERALL_PROGRESS=42%
```

#### D. Display Feature Overview
Show concise summary for each feature:
- Feature name and ID
- Progress percentage
- Status indicator
- File counts (specs, plans, tasks)
- Last activity timestamp
- Highlight current active feature

### Step 4: For Specific Feature Status

**I will provide detailed feature analysis:**

#### A. Feature Detection and Validation
- Locate feature directory structure
- Validate proper `.specpulse` organization
- Check for required subdirectories (specs/, plans/, tasks/)

#### B. File Inventory and Analysis
Count and analyze files:
- **Specification files**: Number and completeness status
- **Plan files**: Implementation plan presence and quality
- **Task files**: Task breakdown structure and progress

#### C. Progress Calculation
Calculate detailed progress metrics:
- **Overall percentage**: Based on task completion status
- **Task distribution**: Completed/in-progress/blocked/pending counts
- **Phase breakdown**: Progress by implementation phases
- **Velocity metrics**: Tasks completed per time period

#### D. Task Status Analysis
Parse task files to determine:
- Individual task status: `[x]` completed, `[ ]` pending, `[>]` in progress, `[!]` blocked
- Dependency relationships and chain status
- Parallel task availability
- Blocker identification and resolution paths

### Step 5: Advanced Analysis Features

#### A. Universal ID System Integration
- Track ID usage across specs, plans, and tasks
- Detect potential ID conflicts before they occur
- Show ID allocation statistics
- Validate ID numbering consistency

#### B. SDD Gates Compliance
- Verify specifications meet SDD standards
- Check task traceability to requirements
- Validate quality assurance presence
- Assess implementation completeness

#### C. Trend Analysis (if historical data available)
- Progress velocity over time
- Completion rate trends
- Blocker frequency and resolution time
- Feature development patterns

#### D. Validation and Health Check
- File structure integrity
- Required section completeness
- Dependency cycle detection
- Permission and access verification

### Step 6: Context Management and Updates

**I will maintain project context:**
- Update `.specpulse/memory/context.md` with latest status
- Track status check history for trend analysis
- Link related features and dependencies
- Maintain searchable status history

## Status Display Formats

### Status Indicators
- `[OK]` - Completed feature
- `[PROG]` - Active development
- `[WAIT]` - In progress (waiting for dependencies)
- `[PAUSED]` - No recent activity
- `[BLOCKED]` - Blocked by issues

### Advanced Features
- **Universal ID System**: Track ID usage, detect conflicts, validate consistency
- **SDD Gates Compliance**: Specification standards, task traceability validation
- **Trend Analysis**: Progress velocity trends, completion rate patterns
- **Health Check**: File structure integrity, dependency validation
- **Context Management**: Automatic context updates and history tracking

## Error Handling and Recovery

### Common Issues and Solutions

#### Context Detection Failures
- **No memory file**: Create initial context structure
- **Invalid feature directory**: Suggest valid feature names
- **Multiple active features**: Prompt to select primary feature
- **Corrupted task files**: Guide through file recovery process

#### Validation Errors
- **Missing directories**: Create proper `.specpulse` structure
- **Invalid file formats**: Provide template corrections
- **Dependency cycles**: Identify and resolve circular references
- **Permission issues**: Guide user through permission fixes

#### Calculation Errors
- **Invalid task statuses**: Correct status marker format
- **Missing progress data**: Recalculate from file timestamps
- **Division by zero**: Handle edge cases in percentage calculations
- **Corrupted ID system**: Rebuild ID mapping from files

This `/sp-status` command provides **comprehensive project tracking** without requiring any SpecPulse CLI installation, using only validated file operations and detailed progress analytics.
"""